<!DOCTYPE html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Movie-Showing</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta name="description" content="Movie Pro"/>
    <meta name="keywords" content="Movie Pro"/>
    <meta name="author" content=""/>
    <meta name="MobileOptimized" content="320"/>
    <!-- Template styles -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/animate.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/font-awesome.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/fonts.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/flaticon.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/owl.carousel.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/owl.theme.default.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/dl-menu.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/nice-select.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/magnific-popup.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/venobox.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/js/plugin/rs_slider/layers.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/js/plugin/rs_slider/navigation.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/js/plugin/rs_slider/settings.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/responsive.css}"/>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/png" th:href="@{/images/header/favicon.ico}"/>
</head>

<body>
<!-- Preloader Start -->
<div id="preloader">
    <div id="status">
        <img th:src="@{/images/header/horoscope.gif}" id="preloader_image" alt="loader"/>
    </div>
</div>

<!-- Navigation Start -->
<header lang="vi" th:replace="fragments/navigation :: navigation"></header>
<!-- Navigation End -->

<!-- prs Slider Start -->
<header lang="vi" th:include="fragments/slider :: slider"></header>
<!-- prs Slider End -->

<!-- Title Wrapper Start -->
<div class="prs_title_main_sec_wrapper">
    <div class="prs_title_img_overlay"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="prs_title_heading_wrapper">
                    <ul>
                        <li><a th:href="@{/}">Home</a></li>
                        <li> > Movie > <span th:text="${status}"></span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Title Wrapper End -->

<!-- prs Slider Start -->
<header lang="vi" th:include="fragments/slider :: slider"></header>
<!-- prs Slider End -->

<link rel="stylesheet" type="text/css" th:href="@{/css/font-awesome.css}"/>
,
<!-- MC Category Sidebar Start -->
<div class="prs_mc_category_sidebar_main_wrapper" style="position: relative; left: -150px;">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 hidden-sm hidden-xs">
                <div class="prs_mcc_left_side_wrapper">
                    <div class="prs_mcc_left_searchbar_wrapper">
                        <input type="text" placeholder="Search Movie">
                        <button><i class="flaticon-tool"></i>
                        </button>
                    </div>
                    <div class="prs_mcc_bro_title_wrapper">
                        <h2>browse title</h2>
                        <ul>
                            <li th:each="category : ${session.categoryAll}">
                                <i class="fa fa-play"></i>
                                <a href="#"
                                   th:text="${category}"
                                   th:attr="data-category=${category}"
                                   onclick="loadMovies(this.getAttribute('data-category')); return false;">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                <div class="prs_mcc_right_side_wrapper">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="prs_mcc_right_side_heading_wrapper">
                                <h2>result</h2>
                            </div>
                        </div>
                        <!-- Web Series Slider Start -->
                        <div class="prs_upcom_slider_main_wrapper">
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                        <div class="col-12 tab-content">
                                            <div role="tabpanel" class="tab-pane active">
                                                <!-- Sử dụng row + col để tạo lưới -->
                                                <div class="row" id="movieListContainerCategory">
                                                    <div th:each="movie : ${movieShowing}"
                                                         class="col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-4">
                                                        <div class="prs_upcom_movie_box_wrapper"
                                                             style="height: 100%; display: flex; flex-direction: column;">
                                                            <div class="prs_upcom_movie_img_box"
                                                                 style="flex-shrink: 0;">
                                                                <img th:src="${movie.smallImageURL}" alt="movie_img"
                                                                     style="width: 100%; height: 400px; object-fit: cover; border-radius: 4px; display: block;"/>
                                                                <div class="prs_upcom_movie_img_overlay"></div>
                                                                <div class="prs_upcom_movie_img_btn_wrapper">
                                                                    <ul>
                                                                        <li><a title='title' rel='external'
                                                                               class="test-popup-link"
                                                                               th:href="${movie.trailerURLWatchLink}">View
                                                                            Trailer</a></li>
                                                                        <li>
                                                                            <a th:href="@{/movie/detail(movieId=${movie.id})}">View
                                                                                Details</a></li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <div class="prs_upcom_movie_content_box"
                                                                 style="flex-grow: 1; margin-top: 10px;">
                                                                <div class="prs_upcom_movie_content_box_inner">
                                                                    <h2
                                                                            style="font-size: 1.1rem; font-weight: bold; height: 40px">
                                                                        Movie name: <a
                                                                            th:href="@{/movie/detail(movieId=${movie.id})}"
                                                                            th:text="${movie.name}"></a></h2>
                                                                    <div style="font-size: 0.9rem; color: #333;">
                                                                        <p><strong>Thể loại:</strong> <span
                                                                                th:text="${movie.categories}">Movie category</span>
                                                                        </p>
                                                                        <p><strong>Thời lượng:</strong> <span
                                                                                th:text="${movie.duration + ' minutes'}">Movie duration</span>
                                                                        </p>
                                                                        <p><strong>Khởi chiếu:</strong> <span
                                                                                th:text="${movie.releaseDate.toString()}">Movie releaseDate</span>
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Web Series Slider End -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- MC Category Sidebar End -->

<!-- prs footer Wrapper Start -->
<header lang="vi" th:include="fragments/footer"></header>
<!-- prs footer Wrapper End -->

<!-- Login Wrapper Start -->
<div class="modal fade st_pop_form_wrapper" id="myModal" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <div class="st_pop_form_heading_wrapper float_left">
                <h3>Log in</h3>
            </div>
            <div class="st_profile_input float_left">
                <label>Email / Mobile Number</label>
                <input type="text"/>
            </div>
            <div class="st_profile__pass_input st_profile__pass_input_pop float_left">
                <input type="password" placeholder="Password"/>
            </div>
            <div class="st_form_pop_fp float_left">
                <h3><a href="#" data-toggle="modal" data-target="#myModa2" target="_blank">Forgot Password?</a></h3>
            </div>
            <div class="st_form_pop_login_btn float_left">
                <a href="https://webstrot.com/html/moviepro/html/page-1-7_profile_settings.html">LOGIN</a>
            </div>
            <div class="st_form_pop_or_btn float_left">
                <h4>or</h4>
            </div>
            <div class="st_form_pop_facebook_btn float_left">
                <a href="#">Connect with Facebook</a>
            </div>
            <div class="st_form_pop_gmail_btn float_left">
                <a href="#">Connect with Google</a>
            </div>
            <div class="st_form_pop_signin_btn float_left">
                <h4>Don’t have an account? <a href="#" data-toggle="modal" data-target="#myModa3" target="_blank">Sign
                    Up</a></h4>
                <h5>I agree to the <a href="#">Terms & Conditions</a> & <a href="#">Privacy Policy</a></h5>
            </div>
        </div>
    </div>
</div>
<div class="modal fade st_pop_form_wrapper" id="myModa2" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <div class="st_pop_form_heading_wrapper st_pop_form_heading_wrapper_fpass float_left">
                <h3>Forgot Password</h3>
                <p>We can help! All you need to do is enter your email ID and follow the instructions!</p>
            </div>
            <div class="st_profile_input float_left">
                <label>Email Address</label>
                <input type="text"/>
            </div>
            <div class="st_form_pop_fpass_btn float_left">
                <a href="#">Verify</a>
            </div>
        </div>
    </div>
</div>
<div class="modal fade st_pop_form_wrapper" id="myModa3" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <div class="st_pop_form_heading_wrapper float_left">
                <h3>Sign Up</h3>
            </div>
            <div class="st_profile_input float_left">
                <label>Email / Mobile Number</label>
                <input type="text"/>
            </div>
            <div class="st_profile__pass_input st_profile__pass_input_pop float_left">
                <input type="password" placeholder="Password"/>
            </div>
            <div class="st_form_pop_fp float_left">
                <h3><a href="#" data-toggle="modal" data-target="#myModa2" target="_blank">Forgot Password?</a></h3>
            </div>
            <div class="st_form_pop_login_btn float_left">
                <a href="https://webstrot.com/html/moviepro/html/page-1-7_profile_settings.html">LOGIN</a>
            </div>
            <div class="st_form_pop_or_btn float_left">
                <h4>or</h4>
            </div>
            <div class="st_form_pop_facebook_btn float_left">
                <a href="#"><i class="fab fa-facebook-f"></i> Connect with Facebook</a>
            </div>
            <div class="st_form_pop_gmail_btn float_left">
                <a href="#"><i class="fab fa-google-plus-g"></i> Connect with Google</a>
            </div>
            <div class="st_form_pop_signin_btn st_form_pop_signin_btn_signup float_left">
                <h5>I agree to the <a href="#">Terms & Conditions</a> & <a href="#">Privacy Policy</a></h5>
            </div>
        </div>
    </div>
</div>
<!-- Login Wrapper End -->

<!-- Main JS Files -->
<script th:src="@{/js/jquery_min.js}"></script>
<script th:src="@{/js/bootstrap.js}"></script>
<script th:src="@{/js/modernizr.js}"></script>
<script th:src="@{/js/owl.carousel.js}"></script>
<script th:src="@{/js/jquery.dlmenu.js}"></script>
<script th:src="@{/js/jquery.sticky.js}"></script>
<script th:src="@{/js/jquery.nice-select.min.js}"></script>
<script th:src="@{/js/jquery.magnific-popup.js}"></script>
<script th:src="@{/js/jquery.bxslider.min.js}"></script>
<script th:src="@{/js/venobox.min.js}"></script>
<script th:src="@{/js/smothscroll_part1.js}"></script>
<script th:src="@{/js/smothscroll_part2.js}"></script>
<script th:src="@{/js/jquery.countTo.js}"></script>
<script th:src="@{/js/jquery.inview.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/jquery.themepunch.revolution.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/jquery.themepunch.tools.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.addon.snow.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.actions.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.carousel.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.kenburn.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.layeranimation.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.migration.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.navigation.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.parallax.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.slideanims.min.js}"></script>
<script th:src="@{/js/plugin/rs_slider/revolution.extension.video.min.js}"></script>
<script th:src="@{/js/custom.js}"></script>
<script th:src="@{/js/movie_showing.js}"></script>

<!-- Thuộc tính th:inline="javascript" là chỉ dẫn của Thymeleaf cho biết
bên trong thẻ này có chứa mã JavaScript, và Thymeleaf sẽ xử lý inline expression
đặc biệt phù hợp với JavaScript. -->
<script th:inline="javascript">
    var movieShowingData = /*[[${movieShowing}]]*/ [];
</script>

<script>
    function loadMovies(categoryName) {
        let filteredMovies;
        // trả về true thì đc add vào list false thì không add vào list
        filteredMovies = movieShowingData.filter(movie => {
            // Nếu categories là chuỗi, so sánh chính xác hoặc chứa categoryName
            if (typeof movie.categories === 'string') {
                // So sánh bằng hoặc kiểm tra chứa categoryName (tuỳ bạn muốn chính xác hay không)
                // return movie.categories === categoryName;
                return movie.categories.includes(categoryName);
            }
            return false;
        });
        renderMovies(filteredMovies);
    }

    function renderMovies(movies) {
        const container = document.getElementById('movieListContainerCategory');
        container.innerHTML = ''; // Xóa nội dung phim cũ

        movies.forEach(movie => {
            const div = document.createElement('div');
            div.className = 'col-lg-4 col-md-4 col-sm-4 col-xs-12 mb-4';

            div.innerHTML = `
          <div class="prs_upcom_movie_box_wrapper" style="height: 100%; display: flex; flex-direction: column;">
            <div class="prs_upcom_movie_img_box" style="flex-shrink: 0;">
              <img src="${movie.smallImageURL || ''}" alt="movie_img"
                   style="width: 100%; height: 400px; object-fit: cover; border-radius: 4px; display: block;"/>
              <div class="prs_upcom_movie_img_overlay"></div>
              <div class="prs_upcom_movie_img_btn_wrapper">
                <ul>
                  <li><a href="${movie.trailerURLWatchLink || '#'}" target="_blank" rel="noopener noreferrer">View Trailer</a></li>
                  <li><a href="/movie/detail?movieId=${movie.id}">View Details</a></li>
                </ul>
              </div>
            </div>
            <div class="prs_upcom_movie_content_box" style="flex-grow: 1; margin-top: 10px;">
              <div class="prs_upcom_movie_content_box_inner">
                <h2 style="font-size: 1.1rem; font-weight: bold; height: 40px;">
                  Movie name: <a href="/movie/detail?movieId=${movie.id}">${movie.name || 'No Title'}</a>
                </h2>
                <div style="font-size: 0.9rem; color: #333;">
                  <p><strong>Thể loại:</strong> <span>${movie.categories || 'N/A'}</span></p>
                  <p><strong>Thời lượng:</strong> <span>${movie.duration ? movie.duration + ' minutes' : 'N/A'}</span></p>
                  <p><strong>Khởi chiếu:</strong> <span>${movie.releaseDate || 'N/A'}</span></p>
                </div>
              </div>
            </div>
          </div>`;

            container.appendChild(div);
        });
    }

</script>


</body>
</html>